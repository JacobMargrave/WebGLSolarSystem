<html><meta charset="utf-8"/> <body> <script src="http://mrdoob.github.com/three.js/build/three.min.js"></script>
<script src="http://mrdoob.github.com/three.js/examples/js/controls/OrbitControls.js"></script>
<script src="https://rawgit.com/dataarts/dat.gui/develop/build/dat.gui.js"></script>
<script src= "https://mrdoob.github.com/three.js/src/loaders/JSONLoader.js"></script> 
<div id='myDiv' style="background:black"></div>
<script>

var renderer, scene, camera, controls, distanceScene, distanceCamera, distanceControls, backgroundScene, backgroundCamera, backgroundControls,
    star_texture, planet_distance, sun_texture, sun_glow, sun_rays, earth_cloud_map, earth_cloud_alpha,
    jupiter_ring_texture, saturn_ring_texture, uranus_ring_texture, neptune_ring_texture, star_geo, star_mat, stars, sun_geo, sun_mat, sun, 
    sun_glow_mat, sun_sprite, sun_flare, sun_rays, mercury, mercury_path, venus, venus_path, earth, earth_path, 
    earth_cloud_geo, earth_cloud_mat, earth_clouds, moon, orbit_moon, mars, mars_path, jupiter, jupiter_path, jupiter_rings_geo, jupiter_rings_mat, 
    jupiter_rings, orbit_jupiter_rings, io, orbit_io, europa, orbit_europa, ganymede, orbit_ganymede, callisto,
    orbit_callisto, saturn, saturn_path, saturn_rings_geo, saturn_rings_mat, saturn_rings, orbit_saturn_rings, mimas, orbit_mimas, enceladus, orbit_enceladus, 
    tethys, orbit_tethys, dione, orbit_dione, rhea, orbit_rhea, titan, orbit_titan, iapetus, orbit_iapetus, uranus, uranus_path, uranus_rings_geo, uranus_rings_mat, 
    uranus_rings, orbit_uranus_rings, miranda, orbit_miranda, ariel, orbit_ariel, umbriel_geo, umbriel, orbit_umbriel, titania, orbit_titania, oberon, orbit_oberon,
    neptune, neptune_path, neptune_rings_geo, neptune_rings_mat, neptune_rings, orbit_neptune_rings, triton, orbit_triton, pluto_charon, pluto, charon, 
    pluto_path, ambLight, backAmbLight, sunlight, mercury_ellipse_mat, mercury_ellipse, mercury_points, mercury_ellipse_geo, mercury_line, venus_ellipse_mat,
    venus_ellipse, venus_points, venus_ellipse_geo, venus_line, earth_ellipse_mat, earth_ellipse, earth_points, earth_ellipse_geo, earth_line,
    mars_ellipse_mat, mars_ellipse, mars_points, mars_ellipse_geo, mars_line, jupiter_ellipse_mat, jupiter_ellipse, jupiter_points, 
    jupiter_ellipse_geo, jupiter_line, saturn_ellipse_mat, saturn_ellipse, saturn_points, saturn_ellipse_geo, saturn_line, uranus_ellipse_mat,
    uranus_ellipse, uranus_points, uranus_ellipse_geo, uranus_line, neptune_ellipse_mat, neptune_ellipse, neptune_points, neptune_ellipse_geo,
    neptune_line, pluto_ellipse_mat, pluto_ellipse, pluto_points, pluto_ellipse_geo, pluto_line, venus_cloud_geo, venus_cloud_mat, venus_clouds,
    venus_cloud_map, mars_cloud_geo, mars_cloud_mat, mars_clouds, mars_cloud_map, sun_camera, mercury_camera, venus_camera, earth_camera,
    mars_camera, jupiter_camera, saturn_camera, uranus_camera, neptune_camera, pluto_camera, view_gui, look_At_Sun, look_At_Mercury,
    look_At_Venus, look_At_Earth, look_At_Mars, look_At_Jupiter, look_At_Saturn, look_At_Uranus, look_At_Neptune, look_At_Pluto, orbit_gui,
    orbits_off, orbits_on, cloud_gui, atmospheres_off, atmospheres_on, titan_clouds_geo, titan_clouds_mat, titan_clouds, 
    titan_haze, blue_haze, titan_upper_haze, titan_camera, look_At_Titan, moon_ellipse, moon_ellipse_mat, moon_points, moon_ellipse_geo, moon_line;
    

var sun_size		 	= 1000; // This is what controls everything related to the size of the planets and their distances

var earth_size		 	= sun_size / 109.0;
var earth_rotation       	= 0.0001; // This is what controls every movement of every planet and moon in the Solar System
var earth_year           	= earth_rotation / 365.256;
var earth_distance       	= sun_size / 0.005;
var earth_eccentricity   	= earth_distance * 0.0167;

var sun_rotation         	= earth_rotation * 0.0399202;

var mercury_size	 	= earth_size * 0.383;
var mercury_rotation     	= earth_rotation * 0.0170515;
var mercury_year         	= earth_year * 4.1666667;
var mercury_distance     	= earth_distance * 0.387;
var mercury_eccentricity 	= mercury_distance * 0.2056;

var venus_size		 	= earth_size * 0.949;
var venus_rotation       	= earth_rotation * -0.0041148; // retrograde rotation
var venus_year           	= earth_year * 1.6129032;
var venus_distance       	= earth_distance * 0.723;
var venus_eccentricity   	= venus_distance * 0.0068;

var mars_size		 	= earth_size * 0.532;
var mars_rotation 	 	= earth_rotation * 0.9746997;
var mars_year 		 	= earth_year * 0.5319149;
var mars_distance 		= earth_distance * 1.524;
var mars_eccentricity 	 	= mars_distance * 0.0934;

var ceres_size			= earth_size * 0.037;
var ceres_rotation		= earth_rotation * 2.6448030;
var ceres_year			= earth_year * 0.2173913;
var ceres_distance		= earth_distance * 2.7675;
var ceres_eccentricity		= ceres_distance * 0.075823;

var jupiter_size	 	= earth_size * 11.21;
var jupiter_rotation 	 	= earth_rotation * 2.4181360;
var jupiter_year 	 	= earth_year * 0.0843170;
var jupiter_distance 	 	= earth_distance * 5.203;
var jupiter_eccentricity 	= jupiter_distance * 0.0484;

var saturn_size		 	= earth_size * 9.45;
var saturn_rotation 	 	= earth_rotation * 2.2748815;
var saturn_year 	 	= earth_year * 0.0339443;
var saturn_distance 	 	= earth_distance * 9.583;
var saturn_eccentricity  	= saturn_distance * 0.0549;

var uranus_size		 	= earth_size * 4.01;
var uranus_rotation 	 	= earth_rotation * 1.3921178;
var uranus_year 	 	= earth_year * 0.0119019;
var uranus_distance 	 	= earth_distance * 19.218;
var uranus_eccentricity  	= uranus_distance * 0.0472;

var neptune_size	 	= earth_size * 3.88;
var neptune_rotation 	 	= earth_rotation * 1.4896470;
var neptune_year 	 	= earth_year * 0.0060691;
var neptune_distance 	 	= earth_distance * 30.110;
var neptune_eccentricity 	= neptune_distance * 0.0086;

var pluto_size		 	= earth_size * 0.186;
var pluto_rotation 	 	= earth_rotation * 0.1565624; 
var pluto_year 		 	= earth_year * 0.0040332;
var pluto_distance 	 	= earth_distance * 39.480;
var pluto_from_barycenter	= earth_distance * 0.0000141045;
var pluto_eccentricity 	 	= pluto_distance * 0.2488;

var eris_size			= earth_size * 0.091;
var eris_rotation		= earth_rotation * 0.9266409;
var eris_year			= earth_year * 0.0017920;
var eris_distance		= earth_distance * 67.789;
var eris_eccentricity		= eris_distance * 0.44068;

var sedna_size			= earth_size * 0.0830981;
var sedna_rotation		= earth_rotation * 2.3362212;
var sedna_year			= earth_year * 0.0000877;
var sedna_distance		= earth_distance * 506.8;
var sedna_eccentricity		= sedna_distance * 0.85491;

// Moon Size, Motion, and Distance Parameters
var moon_size		 	= earth_size * 0.2724;
var moon_rotation	 	= earth_rotation * 0.036601;
var moon_distance	 	= earth_distance * 0.00257;
var moon_eccentricity	 	= moon_distance * 0.0549;

var io_size		 	= earth_size * 0.286;
var io_rotation		 	= earth_rotation * 0.565247;
var io_distance		 	= earth_distance * 0.002819;
var io_eccentricity	 	= io_distance * 0.0041;

var europa_size		 	= earth_size * 0.245;
var europa_rotation	 	= earth_rotation * 0.281596;
var europa_distance	 	= earth_distance * 0.004485;
var europa_eccentricity	 	= europa_distance * 0.009;

var ganymede_size	 	= earth_size * 0.413;
var ganymede_rotation	 	= earth_rotation * 0.139771;
var ganymede_distance	 	= earth_distance * 0.007155;
var ganymede_eccentricity	= ganymede_distance * 0.0013;

var callisto_size	 	= earth_size * 0.378;
var callisto_rotation	 	= earth_rotation * 0.059920;
var callisto_distance	 	= earth_distance * 0.012585;
var callisto_eccentricity	= callisto_distance * 0.0074;

var mimas_size		 	= earth_size * 0.0311;
var mimas_rotation	 	= earth_rotation * 1.061571;
var mimas_distance	 	= earth_distance * 0.00124;
var mimas_eccentricity	 	= mimas_distance * 0.0196;

var enceladus_size	 	= earth_size * 0.0395;
var enceladus_rotation	 	= earth_rotation * 0.729811;
var enceladus_distance	 	= earth_distance * 0.001591;
var enceladus_eccentricity	= enceladus_distance * 0.0047;

var tethys_size		 	= earth_size * 0.083;
var tethys_rotation	 	= earth_rotation * 0.529717;
var tethys_distance	 	= earth_distance * 0.001969;
var tethys_eccentricity		= tethys_distance * 0.0001;

var dione_size		 	= earth_size * 0.088;
var dione_rotation	 	= earth_rotation * 0.365077;
var dione_distance	 	= earth_distance * 0.002523;
var dione_eccentricity		= dione_distance * 0.0022;

var rhea_size		 	= earth_size * 0.1198;
var rhea_rotation	 	= earth_rotation * 0.221326;
var rhea_distance	 	= earth_distance * 0.003523;
var rhea_eccentricity		= rhea_distance * 0.0012583;

var titan_size		 	= earth_size * 0.404;
var titan_rotation	 	= earth_rotation * 0.062716;
var titan_distance	 	= earth_distance * 0.008168;
var titan_eccentricity	 	= titan_distance * 0.0288;

var iapetus_size	 	= earth_size * 0.115;
var iapetus_rotation	 	= earth_rotation * 0.012607;
var iapetus_distance	 	= earth_distance * 0.023803;
var iapetus_eccentricity	= iapetus_distance * 0.0286125;

var miranda_size	 	= earth_size * 0.037;
var miranda_rotation	 	= earth_rotation * 0.707474;
var miranda_distance	 	= earth_distance * 0.000865;
var miranda_eccentricity	= miranda_distance * 0.0013;

var ariel_size		 	= earth_size * 0.0908;
var ariel_rotation	 	= earth_rotation * 0.396825;
var ariel_distance	 	= earth_distance * 0.001277;
var ariel_eccentricity		= ariel_distance * 0.0012;

var umbriel_size	 	= earth_size * 0.092;
var umbriel_rotation	 	= earth_rotation * 0.241313;
var umbriel_distance	 	= earth_distance * 0.001778;
var umbriel_eccentricity	= umbriel_distance * 0.0039;

var titania_size	 	= earth_size * 0.1235;
var titania_rotation	 	= earth_rotation * 0.114860;
var titania_distance	 	= earth_distance * 0.002914;
var titania_eccentricity	= titania_distance * 0.0011;

var oberon_size		 	= earth_size * 0.1194;
var oberon_rotation	 	= earth_rotation * 0.074276;
var oberon_distance	 	= earth_distance * 0.003901;
var oberon_eccentricity		= oberon_distance * 0.0014;

var triton_size		 	= earth_size * 0.2122;
var triton_rotation	 	= earth_rotation * -0.170159; // retrograde
var triton_distance	 	= earth_distance * 0.002371;
var triton_eccentricity 	= triton_distance * 0.000016;

var charon_size		 	= earth_size * 0.095;
var charon_from_barycenter	= earth_distance * 0.00011691343;

var egg_size			= earth_size * 2.0;
var egg_rotation		= earth_rotation*2.0;
var egg_year			= earth_year * 3.2;
var egg_distance 		= earth_distance * 50.0;
var egg_eccentricity 		= egg_distance * 0.112;

renderer = new THREE.WebGLRenderer({antialias: true, alpha: false});
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.context.getShaderInfoLog = function(){return ''};
document.getElementById('myDiv').appendChild(renderer.domElement);

renderer.shadowMap.enabled = true;
renderer.shadowMap.type = THREE.BasicShadowMap;
	
// Creating the main scene
scene = new THREE.Scene();
camera = new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight, 0.1, 600000000);
camera.position.z = earth_distance;

// To move the scene around
controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableZoom = true;
controls.enablePan = false;

// Creating a background scene
backgroundScene = new THREE.Scene();
backgroundCamera = new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight, 0.1, 300000);
backgroundCamera.position.z = 800;

// To move the background around (to make it more realistic)
backgroundControls = new THREE.OrbitControls(backgroundCamera, renderer.domElement);
backgroundControls.enableZoom = false;
backgroundControls.enablePan = false;

// Load the textures
star_texture 		= new THREE.TextureLoader().load("images/milky_way.jpg");
sun_texture  		= new THREE.TextureLoader().load("images/sun.jpg");
sun_star		= new THREE.TextureLoader().load("images/lensflare.png");
venus_cloud_map  	= new THREE.TextureLoader().load("images/venuscloudmap.jpg");
earth_cloud_map  	= new THREE.TextureLoader().load("images/earthcloudmap.jpg");
earth_cloud_alpha  	= new THREE.TextureLoader().load("images/earthcloudmaptrans.jpg");
mars_cloud_map  	= new THREE.TextureLoader().load("images/marscloudmap.png");
jupiter_ring_texture  	= new THREE.TextureLoader().load("images/jupiterringcolor.png");
saturn_ring_texture  	= new THREE.TextureLoader().load("images/saturnringcolor.png");
titan_cloud_map		= new THREE.TextureLoader().load("images/titan.jpg");
titan_haze		= new THREE.TextureLoader().load("Images/titanhaze.png");
uranus_ring_texture  	= new THREE.TextureLoader().load("images/uranusringcolor.png");
neptune_ring_texture  	= new THREE.TextureLoader().load("images/neptuneringcolor.png");
egg_texture		= new THREE.TextureLoader().load("images/egg.jpg");

//********************************************************

// Adding the stars in the background
star_geo = new THREE.SphereGeometry(100000, 32, 32);
star_mat = new THREE.MeshPhongMaterial({map: star_texture, side: THREE.BackSide, shininess: 0,});
stars = new THREE.Mesh(star_geo, star_mat);
stars.material.depthTest = false;
stars.material.depthWrite = false;
backgroundScene.add(stars);

//********************************************************

// New function for easy planet/dwarf planet/moon creation
var Planet = function(radius, texture, bumpTexture, bumpScale, specTexture, specular, shininess) {
	this.radius = radius;
	this.texture = texture;
	this.bumpTexture = bumpTexture;
	this.bumpScale = bumpScale;
	this.specTexture = specTexture;
	this.specular = specular;
	this.shininess = shininess;
	this.init = function() {
		var g = new THREE.SphereGeometry(this.radius, 50, 50);
		var onloadT = new THREE.TextureLoader().load(this.texture);
		var onLoadBump = new THREE.TextureLoader().load(this.bumpTexture);
		var onloadSpec = new THREE.TextureLoader().load(this.specTexture);
		onloadT.anisotropy = 8;
		var m = new THREE.MeshPhongMaterial({map: onloadT, bumpMap: onLoadBump, bumpScale: this.bumpScale, 
			specularMap: onloadSpec, specular: this.specular, shininess: this.shininess});
		var M = new THREE.Mesh(g,m);
		M.castShadow = true;
		return M;
	}
}

// New function for easy orbit generation
var Orbit = function(radius, eccentricity, inclination, ascendingAngle, color, numPoints) {
	this.radius = radius;
	this.eccentricity = eccentricity;
	this.inclination = inclination;
	this.ascendingAngle = ascendingAngle;
	this.color = color;
	this.numPoints = numPoints;
	this.draw = function(scene) {
		var og = new THREE.Geometry();
		var om = new THREE.PointsMaterial({color: this.color, size: 1, opacity: 0.3, sizeAttenuation: false});
		for (var i = 0; i < this.numPoints; i++) {
			var v = new THREE.Vector3();
			v.x = Math.sin(Math.PI/180*i)* this.radius + this.eccentricity;
			v.z = Math.cos(Math.PI/180*i)* (this.radius - 0.5*this.eccentricity);
			og.vertices.push(v);
		}
		var obj = new THREE.Points(og, om);
		obj.rotation.z = this.inclination;
		obj.rotation.y = this.ascendingAngle;
		return obj;
	}
}

//********************************************************

// Adding the Sun to the Solar System
sun_geo = new THREE.SphereGeometry(sun_size, 50, 50);
sun_mat = new THREE.MeshBasicMaterial({map: sun_texture,});
sun = new THREE.Mesh(sun_geo, sun_mat);
scene.add(sun);

// Viewing the Sun from a distance...lensflare effect
sun_point = new THREE.SpriteMaterial({map: sun_star, color: 0xffffff, transparent: true, depthWrite: false,
	blending: THREE.AdditiveBlending,});
sun_distance = new THREE.Sprite(sun_point);
sun_distance.scale.set(100*sun_size, 100*sun_size, 1.0);
sun.add(sun_distance);

//********************************************************

// Adding Mercury to the Solar System
mercury = new Planet(mercury_size, "images/mercury.jpg", "images/mercurybump.jpg", 0.05, "", 0, 0).init();
mercury_path = new THREE.Object3D();
mercury_path.rotation.z = (7/180)*Math.PI; // Orbital Inclination
mercury_path.rotation.y = (48.3/180)*Math.PI; // Right Ascension of Ascending Node
mercury_path.add(mercury);
scene.add(mercury_path);

//********************************************************

// Adding Venus to the Solar System
venus = new Planet(venus_size, "images/venus.jpg", "images/venusbump.jpg", 0.05, "", 0, 0).init();
venus_path = new THREE.Object3D();
venus_path.rotation.z = (3.4/180)*Math.PI; // Orbital Inclination
venus_path.rotation.y = (76.6/180)*Math.PI; // Right Ascension of Ascending Node
venus_path.add(venus);
scene.add(venus_path);

// Adding Venus's toxic clouds
venus_cloud_geo = new THREE.SphereGeometry(1.01*venus_size, 50, 50);
venus_cloud_mat = new THREE.MeshPhongMaterial({map: venus_cloud_map, side: THREE.FrontSide, opacity: 1, transparent: false,
	shininess: 0,});
venus_clouds = new THREE.Mesh(venus_cloud_geo, venus_cloud_mat);
venus.add(venus_clouds);

//********************************************************

// Adding Earth to the Solar System
earth = new Planet(earth_size, "images/earth.jpg", "earthbump1k.jpg", 0.05, "images/earthspec1k.jpg", 0x555555, ).init();
earth_path = new THREE.Object3D();
earth_path.rotation.z = 0; // Orbital Inclination; 0 because Earth's orbit represents the ecliptic
earth_path.rotation.y = (175/180)*Math.PI; // Right Ascension of Ascending Node
earth_path.add(earth);
scene.add(earth_path);

// Adding Earth's Clouds
earth_cloud_geo = new THREE.SphereGeometry(1.01*earth_size, 50, 50);
earth_cloud_mat = new THREE.MeshPhongMaterial({map: earth_cloud_map, alphaMap: earth_cloud_alpha, side: THREE.FrontSide, opacity: 0.8,
	transparent: true, depthWrite: false,});
earth_clouds = new THREE.Mesh(earth_cloud_geo, earth_cloud_mat);
earth.add(earth_clouds);

//*****************
// The Moon
//*****************	

// Adding the Moon to the Solar System
moon = new Planet(moon_size, "images/moon.jpg", "images/moonbump.jpg", 0.05, "", 0, 0).init();
orbit_moon = new THREE.Object3D();
moons_orbit = new THREE.Object3D();
orbit_moon.rotation.z = (-18.305/180)*Math.PI; // Orbital Inclination (relative to Earth's equator)
orbit_moon.rotation.y = (125/180)*Math.PI; // Right Ascension of Ascending Node
earth.add(moons_orbit);
moons_orbit.add(orbit_moon);
orbit_moon.add(moon);

//********************************************************

// Adding Mars to the Solar System
mars = new Planet(mars_size, "images/mars.jpg", "images/marsbump.jpg", 0.05, "", 0, 0).init();
mars_path = new THREE.Object3D();
mars_path.rotation.z = (1.85/180)*Math.PI; // Orbital Inclination
mars_path.rotation.y = (49.7/180)*Math.PI; // Right Ascension of Ascending Node
mars_path.add(mars);
scene.add(mars_path);

// Adding dust and clouds in Mars's thin atmosphere
mars_cloud_geo = new THREE.SphereGeometry(1.01*mars_size, 50, 50);
mars_cloud_mat = new THREE.MeshPhongMaterial({map: mars_cloud_map, alphaMap: mars_cloud_map, side: THREE.FrontSide, opacity: 0.8,
	transparent: true, depthWrite: false,});
mars_clouds = new THREE.Mesh(mars_cloud_geo, mars_cloud_mat);
mars.add(mars_clouds);

//*********************************************************

// Adding Ceres to the Solar System
ceres = new Planet(ceres_size, "images/ceres.jpg", "images/ceresbump.png", 0.05, "", 0, 0).init();
ceres_path = new THREE.Object3D();
ceres_path.rotation.z = (10.593/180)*Math.PI; // Orbital Inclination
ceres_path.rotation.y = (80.3/180)*Math.PI; // Right Ascension of Ascending Node
ceres_path.add(ceres);
scene.add(ceres_path);

//*********************************************************

// Adding Jupiter to the Solar System
jupiter = new Planet(jupiter_size, "images/jupiter.jpg", "", 0, "", 0, 0).init();
jupiter.geometry.applyMatrix(new THREE.Matrix4().makeScale(1.0, 0.93, 1.0)); // Equatorial Bulge
jupiter_path = new THREE.Object3D();
jupiter_path.rotation.z = (1.3/180)*Math.PI; // Orbital Inclination
jupiter_path.rotation.y = (100/180)*Math.PI; // Right Ascension of Ascending Node
jupiter_path.add(jupiter);
scene.add(jupiter_path);

// Adding Jupiter's Rings
jupiter_rings_geo = new THREE.RingGeometry(1.72*jupiter_size, 1.806*jupiter_size, 36);
jupiter_rings_mat = new THREE.MeshPhongMaterial({map: jupiter_ring_texture, alphaMap: jupiter_ring_texture, color: 0xffffff,
	specular: 0, shininess: 0, emissive: 0, side: THREE.DoubleSide, transparent: true, depthWrite: false, opacity: 4,});
jupiter_rings = new THREE.Mesh(jupiter_rings_geo, jupiter_rings_mat);
orbit_jupiter_rings = new THREE.Object3D();
jupiter.add(orbit_jupiter_rings);
orbit_jupiter_rings.add(jupiter_rings);
jupiter.add(jupiter_rings);

//***********************************
// Jupiter's Moons
//***********************************

// Io
io = new Planet(io_size, "images/io.jpg", "images/iobump.jpg", 0.05, "", 0, 0).init();
orbit_io = new THREE.Object3D();
ios_orbit = new THREE.Object3D();
orbit_io.rotation.z = (0.05/180)*Math.PI; // Orbitial Inclination (relative to Jupiter's equator)
orbit_io.rotation.y = (338/180)*Math.PI; // Right Ascension of Ascending Node
jupiter.add(ios_orbit);
ios_orbit.add(orbit_io);
orbit_io.add(io);

// Europa
europa = new Planet(europa_size, "images/europa.jpg", "images/europabump.jpg", 0.05, "images/europaspecular.jpg", 0x555555,).init();
orbit_europa = new THREE.Object3D();
europas_orbit = new THREE.Object3D();
orbit_europa.rotation.z = (0.470/180)*Math.PI; // Orbital Inclination (relative to Jupiter's equator)
orbit_europa.rotation.y = (339/180)*Math.PI; // Right Ascension of Ascending Node
jupiter.add(europas_orbit);
europas_orbit.add(orbit_europa);
orbit_europa.add(europa);

// Ganymede
ganymede = new Planet(ganymede_size, "images/ganymede.jpg", "images/ganymedebump.jpg", 0.05, "images/ganymedespecular.jpg", 0x555555,).init();
orbit_ganymede = new THREE.Object3D();
ganymedes_orbit = new THREE.Object3D();
orbit_ganymede.rotation.z = (0.20/180)*Math.PI; // Orbital Inclination (relative to Jupiter's equator)
orbit_ganymede.rotation.y = (340/180)*Math.PI; // Right Ascension of Ascending Node
jupiter.add(ganymedes_orbit);
ganymedes_orbit.add(orbit_ganymede);
orbit_ganymede.add(ganymede);

// Callisto
callisto = new Planet(callisto_size, "images/callisto.png", "images/callistobump.jpg", 0.05, "images/callistospecular.jpg", 0x555555,).init();
orbit_callisto = new THREE.Object3D();
callistos_orbit = new THREE.Object3D();
orbit_callisto.rotation.z = (-1.113/180)*Math.PI; // Orbital Inclination (relative to Jupiter's equator)
orbit_callisto.rotation.y = (336/180)*Math.PI; // Right Ascension of Ascending Node
jupiter.add(callistos_orbit);
callistos_orbit.add(orbit_callisto);
orbit_callisto.add(callisto);

//************************************************

// Adding Saturn to the Solar System
saturn = new Planet(saturn_size, "images/saturn.jpg", "", 0, "", 0, 0).init();
saturn.geometry.applyMatrix(new THREE.Matrix4().makeScale(1.0, 0.9, 1.0)); // Equatorial Bulge
saturn_path = new THREE.Object3D();
saturn_path.rotation.z = (2.5/180)*Math.PI; // Orbital Inclination
saturn_path.rotation.y = (114/180)*Math.PI; // Right Ascension of Ascending Node
saturn_path.add(saturn);
scene.add(saturn_path);

// Adding Saturn's Rings
saturn_rings_geo = new THREE.RingGeometry(1.110*saturn_size, 2.326*saturn_size, 36);
saturn_rings_mat = new THREE.MeshPhongMaterial({map: saturn_ring_texture, alphaMap: saturn_ring_texture, color: 0xffffff,
	specular: 0x555555, shininess: 3, emissive: 10, side: THREE.DoubleSide, transparent: true, opacity: 2, depthWrite: false,});
saturn_rings = new THREE.Mesh(saturn_rings_geo, saturn_rings_mat);
orbit_saturn_rings = new THREE.Object3D();
saturn.add(orbit_saturn_rings);
orbit_saturn_rings.add(saturn_rings);
saturn.add(saturn_rings);

//***********************************
// Saturn's Moons
//*********************************** 

// Mimas
mimas = new Planet(mimas_size, "images/mimas.jpg", "images/mimasbump.jpg", 0.05, "images/mimasspecular.jpg", 0x555555, 10).init();
orbit_mimas = new THREE.Object3D();
mimass_orbit = new THREE.Object3D();
orbit_mimas.rotation.z = (1.574/180)*Math.PI; // Orbital Inclination (relative to Saturn's equator)
orbit_mimas.rotation.y = (167/180)*Math.PI; // Right Ascension of Ascending Node
saturn.add(mimass_orbit);
mimass_orbit.add(orbit_mimas);
orbit_mimas.add(mimas);

// Enceladus
enceladus = new Planet(enceladus_size, "images/enceladus.jpg", "images/enceladusbump.jpg", 0.05, "images/enceladusspecular.jpg", 0x555555,).init();
orbit_enceladus = new THREE.Object3D();
enceladuss_orbit = new THREE.Object3D();
orbit_enceladus.rotation.z = (0.019/180)*Math.PI; // Orbital Inclination (relative to Saturn's equator)
orbit_enceladus.rotation.y = (170/180)*Math.PI; // Right Ascension of Ascending Node
saturn.add(enceladuss_orbit);
enceladuss_orbit.add(orbit_enceladus);
orbit_enceladus.add(enceladus);

// Tethys
tethys = new Planet(tethys_size, "images/tethys.jpg", "images/tethysbump.jpg", 0.05, "images/tethysspecular.jpg", 0x555555, 20).init();
orbit_tethys = new THREE.Object3D();
tethyss_orbit = new THREE.Object3D();
orbit_tethys.rotation.z = (1.120/180)*Math.PI; // Orbital Inclination (relative to Saturn's equator)
orbit_tethys.rotation.y = (170/180)*Math.PI; // Right Ascension of Ascending Node
saturn.add(tethyss_orbit);
tethyss_orbit.add(orbit_tethys);
orbit_tethys.add(tethys);

// Dione
dione = new Planet(dione_size, "images/dione.jpg", "images/dionebump.jpg", 0.05, "images/dionespecular.jpg", 0x555555, 20).init();
orbit_dione = new THREE.Object3D();
diones_orbit = new THREE.Object3D();
orbit_dione.rotation.z = (0.019/180)*Math.PI; // Orbital Inclination (relative to Saturn's equator)
orbit_dione.rotation.y = (170/180)*Math.PI; // Right Ascension of Ascending Node
saturn.add(diones_orbit);
diones_orbit.add(orbit_dione);
orbit_dione.add(dione);	

// Rhea
rhea = new Planet(rhea_size, "images/rhea.jpg", "images/rheabump.jpg", 0.05, "images/rheaspecular.jpg", 0x555555, 10).init();
orbit_rhea = new THREE.Object3D();
rheas_orbit = new THREE.Object3D();
orbit_rhea.rotation.z = (0.345/180)*Math.PI; // Orbital Inclination (relative to Saturn's equator)
orbit_rhea.rotation.y = (170/180)*Math.PI; // Right Ascension of Ascending Node
saturn.add(rheas_orbit);
rheas_orbit.add(orbit_rhea);
orbit_rhea.add(rhea);

// Titan, Saturn's Largest Moon
titan = new Planet(titan_size, "images/titansurface.png", "images/titanbump.jpg", 0.05, "images/titanspecmap.jpg", 0x555555,).init();
orbit_titan = new THREE.Object3D();
titans_orbit = new THREE.Object3D();
orbit_titan.rotation.z = (0.34854/180)*Math.PI; // Orbital Inclination (relative to Saturn's equator)
orbit_titan.rotation.y = (170/180)*Math.PI; // Right Ascension of Ascending Node
saturn.add(titans_orbit);
titans_orbit.add(orbit_titan);
orbit_titan.add(titan);

// Adding Titan's clouds
titan_cloud_geo = new THREE.SphereGeometry(1.01*titan_size, 50, 50);
titan_cloud_mat = new THREE.MeshPhongMaterial({map: titan_cloud_map, side: THREE.FrontSide, opacity: 1, transparent: false,
        shininess: 0,});
titan_clouds = new THREE.Mesh(titan_cloud_geo, titan_cloud_mat);
titan.add(titan_clouds);

// Adding Titan's upper atmospheric haze
blue_haze = new THREE.SpriteMaterial({map: titan_haze, color: 0x0000ff, transparent: true, depthWrite: false,
        blending: THREE.AdditiveBlending,});
titan_upper_haze = new THREE.Sprite(blue_haze);
titan_upper_haze.scale.set(3*titan_size, 3*titan_size, 1.0);
titan.add(titan_upper_haze);


// Iapetus
iapetus = new Planet(iapetus_size, "images/iapetus.jpg", "images/iapetusbump.jpg", 0.05, "images/iapetusspecular.jpg", 0x555555, 10).init();
orbit_iapetus = new THREE.Object3D();
iapetuss_orbit = new THREE.Object3D();
orbit_iapetus.rotation.z = (15.47/180)*Math.PI; // Orbital Inclination (relative to Saturn's equator)
orbit_iapetus.rotation.y = (131/180)*Math.PI; // Right Ascension of Ascending Node
saturn.add(iapetuss_orbit);
iapetuss_orbit.add(orbit_iapetus);
orbit_iapetus.add(iapetus);

//*****************************************************

// Adding Uranus to the Solar System
uranus = new Planet(uranus_size, "images/uranus.jpg", "", 0, "", 0, 0).init();
uranus.geometry.applyMatrix(new THREE.Matrix4().makeScale(1.0, 0.98, 1.0));
uranus_path = new THREE.Object3D();
uranus_path.rotation.z = (0.772/180)*Math.PI; // Orbital Inclination
uranus_path.rotation.y = (74/180)*Math.PI; // Right Ascension of Ascending Node
uranus_path.add(uranus);
scene.add(uranus_path);

// Adding Uranus's Rings
uranus_rings_geo = new THREE.RingGeometry(1.637*uranus_size, 2.006*uranus_size, 36);
uranus_rings_mat = new THREE.MeshPhongMaterial({map: uranus_ring_texture, alphaMap: uranus_ring_texture, color: 0xffffff,
	specular: 0, shininess: 0, emissive: 0, side: THREE.DoubleSide, transparent: true, depthWrite: false, opacity: 1,});
uranus_rings = new THREE.Mesh(uranus_rings_geo, uranus_rings_mat);
orbit_uranus_rings = new THREE.Object3D();
uranus.add(orbit_uranus_rings);
orbit_uranus_rings.add(uranus_rings);
uranus.add(uranus_rings);

//******************************
// Uranus's Moons...
//******************************

// Miranda
miranda = new Planet(miranda_size, "images/miranda.jpg", "images/mirandabump.jpg", 0.05, "images/mirandaspecular.jpg", 0x555555, 15).init();
orbit_miranda = new THREE.Object3D();
mirandas_orbit = new THREE.Object3D();
orbit_miranda.rotation.z = (4.232/180)*Math.PI; // Orbital Inclination (relative to Uranus's equator)
orbit_miranda.rotation.y = (172/180)*Math.PI; // Right Ascension of the Ascending Node
uranus.add(mirandas_orbit);
mirandas_orbit.add(orbit_miranda);
orbit_miranda.add(miranda);

// Ariel
ariel = new Planet(ariel_size, "images/ariel.jpg", "images/arielbump.jpg", 0.05, "images/arielspecular.jpg", 0x555555, 15).init();
orbit_ariel = new THREE.Object3D();
ariels_orbit = new THREE.Object3D();
orbit_ariel.rotation.z = (0.260/180)*Math.PI; // Orbital Inclination (relative to Uranus's equator)
orbit_ariel.rotation.y = (168/180)*Math.PI; // Right Ascension of the Ascending Node
uranus.add(ariels_orbit);
ariels_orbit.add(orbit_ariel);
orbit_ariel.add(ariel);

// Umbriel
umbriel = new Planet(umbriel_size, "images/umbriel.jpg", "images/umbrielbump.jpg", 0.05, "images/umbrielspecular.jpg", 0x555555, 10).init();
orbit_umbriel = new THREE.Object3D();
umbriels_orbit = new THREE.Object3D();
orbit_umbriel.rotation.z = (0.128/180)*Math.PI; // Orbital Inclination (relative to Uranus's equator)
orbit_umbriel.rotation.y = (168/180)*Math.PI; // Right Ascension of the Ascending Node
uranus.add(umbriels_orbit);
umbriels_orbit.add(orbit_umbriel);
orbit_umbriel.add(umbriel);

// Titania
titania = new Planet(titania_size, "images/titania.jpg", "images/titaniabump.jpg", 0.05, "images/titaniaspecular.jpg", 0x555555, 10).init();
orbit_titania = new THREE.Object3D();
titanias_orbit = new THREE.Object3D();
orbit_titania.rotation.z = (0.340/180)*Math.PI; // Orbital Inclination (relative to Uranus's equator)
orbit_titania.rotation.y = (168/180)*Math.PI; // Right Ascension of the Ascending Node
uranus.add(titanias_orbit);
titanias_orbit.add(orbit_titania);
orbit_titania.add(titania);

// Oberon
oberon = new Planet(oberon_size, "images/oberon.jpg", "images/oberonbump.jpg", 0.05, "images/oberonspecular.jpg", 0x555555, 10).init();
orbit_oberon = new THREE.Object3D();
oberons_orbit = new THREE.Object3D();
orbit_oberon.rotation.z = (0.058/180)*Math.PI; // Orbital Inclination (relative to Uranus's equator)
orbit_oberon.rotation.y = (168/180)*Math.PI; // Right Ascension of the Ascending Node
uranus.add(oberons_orbit);
oberons_orbit.add(orbit_oberon);
orbit_oberon.add(oberon);

//************************************************

// Adding Neptune to the Solar System
neptune = new Planet(neptune_size, "images/neptune.jpg", "", 0, "", 0, 0).init();
neptune.geometry.applyMatrix(new THREE.Matrix4().makeScale(1.0, 0.98, 1.0));
neptune_path = new THREE.Object3D();
neptune_path.rotation.z = (1.77/180)*Math.PI; // Orbital Inclination
neptune_path.rotation.y = (132/180)*Math.PI; // Right Ascension of Ascending Node
neptune_path.add(neptune);
scene.add(neptune_path);

// Adding Neptune's Rings
neptune_rings_geo = new THREE.RingGeometry(1.692*neptune_size, 2.541*neptune_size, 36);
neptune_rings_mat = new THREE.MeshPhongMaterial({map: neptune_ring_texture, alphaMap: neptune_ring_texture, color: 0xffffff,
	specular: 0, shininess: 0, emissive: 0, side: THREE.DoubleSide, transparent: true, depthWrite: false, opacity: 3,});
neptune_rings = new THREE.Mesh(neptune_rings_geo, neptune_rings_mat);
orbit_neptune_rings = new THREE.Object3D();
neptune.add(orbit_neptune_rings);
orbit_neptune_rings.add(neptune_rings);
neptune.add(neptune_rings);

//****************************
// Neptune's Moons
//****************************

// Triton
triton = new Planet(triton_size, "images/triton.png", "images/tritonbump.jpg", 0.05, "images/tritonspecular.jpg", 0x555555, 10).init();
orbit_triton = new THREE.Object3D();
tritons_orbit = new THREE.Object3D();
orbit_triton.rotation.z = (-23.115/180)*Math.PI; // Orbital Inclination (relative to Neptune's equator)
orbit_triton.rotation.y = (179/180)*Math.PI; // Right Ascension of Ascending Node
neptune.add(tritons_orbit);
tritons_orbit.add(orbit_triton);
orbit_triton.add(triton);

//***********************************************

// Adding Pluto-Charon center of gravity
pluto_charon = new THREE.Object3D();

// Adding Pluto to the Solar System (Because why not???)
pluto = new Planet(pluto_size, "images/pluto.png", "images/plutobump.jpg", 0.05, "images/plutospecular.jpg", 0x555555, 5).init();
pluto_charon.add(pluto);
pluto.position.x = pluto_from_barycenter;

// Adding Pluto's atmospheric haze
pluto_haze = new THREE.SpriteMaterial({map: titan_haze, color: 0x003284, transparent: true, depthWrite: false,
	blending: THREE.AdditiveBlending,});
pluto_upper_haze = new THREE.Sprite(pluto_haze);
pluto_upper_haze.scale.set(2.75*pluto_size, 2.75*pluto_size, 1.0);
pluto.add(pluto_upper_haze);

// Charon, Pluto's largest moon
charon = new Planet(charon_size, "images/charon.png", "images/charonbump.jpg", 0.05, "images/charonspecular.jpg", 0x555555, 5).init();
pluto_charon.add(charon);
charon.position.x = -charon_from_barycenter;

pluto_path = new THREE.Object3D();
pluto_path.rotation.z = (17/180)*Math.PI; // Orbital Inclination
pluto_path.rotation.y = (110/180)*Math.PI; // Right Ascension of Ascending Node
pluto_path.add(pluto_charon);
scene.add(pluto_path);

//********************************************************

// Adding Eris to the Solar System

eris = new Planet(eris_size, "images/eris.jpg", "", 0, "", 0, 0).init();
eris_path = new THREE.Object3D();
eris_path.rotation.z = (44.0445/180)*Math.PI; // Orbital Inclination
eris_path.rotation.y = (36.1/180)*Math.PI; // Right Ascension of Ascending Node
eris_path.add(eris);
scene.add(eris_path);

//*******************************************************

// Adding Sedna to the Solar System

sedna = new Planet(sedna_size, "images/sedna.jpg", "", 0, "", 0, 0).init();
sedna_path = new THREE.Object3D();
sedna_path.rotation.z = (11.92872/180)*Math.PI; // Orbital Inclination
sedna_path.rotation.y = (144/180)*Math.PI; // Right Ascension of Ascending Node
sedna_path.add(sedna);
scene.add(sedna_path);

//*******************************************************

//Adding egg to the solar System
var points = [];
for ( var deg = 0; deg <= 180; deg += 6 ) {

    var rad = Math.PI * deg / 180;
    var point = new THREE.Vector2( egg_size * ( 0.72 + .08 * Math.cos( rad ) ) * Math.sin( rad ), - Math.cos( rad ) * egg_size ); // the "egg equation"
    //console.log( point ); // x-coord should be greater than zero to avoid degenerate triangles; it is not in this formula.
    points.push( point );

}

egg_geo = new THREE.LatheBufferGeometry( points, 32 );
//egg_geo = new THREE.SphereGeometry( egg_size, 50, 50 );
//egg_geo.applyMatrix(new THREE.Matrix4().makeScale(1.0, 0.93, 1.0)); // Equatorial bulge
egg_mat = new THREE.MeshBasicMaterial({map: egg_texture});
egg = new THREE.Mesh(egg_geo, egg_mat);
egg_path = new THREE.Object3D();
egg_path.rotation.z = 0; // Orbital Inclination; 0 because egg's orbit represents the ecliptic
egg_path.rotation.y = (175/180)*Math.PI; // Right Ascension of Ascending Node
egg_path.add(egg);
scene.add(egg_path);

//********************************************************

//***********************************************

// Add Lighting to the Solar System
ambLight = new THREE.AmbientLight(0x282828);
scene.add(ambLight);
backAmbLight = new THREE.AmbientLight(0xbebcd6);
backgroundScene.add(backAmbLight);
sunlight = new THREE.PointLight(0xffffff, 1, 22000000);
sunlight.position.set(0,0,0);
sunlight.castShadow = true;

sunlight.shadow.mapSize.width = 512;
sunlight.shadow.mapSize.height = 512;
sunlight.shadow.camera.near = 0.5;
sunlight.shadow.camera.far = /*600000000*/ 500;

scene.add(sunlight);

//***********************
// Orbits!!
//***********************

// Mercury's Orbit
mercury_line = new Orbit(mercury_distance, mercury_eccentricity, (7/180)*Math.PI, (48.3/180)*Math.PI, 0xd3d3d3, 1000).draw();
scene.add(mercury_line);

// Venus's Orbit
venus_line = new Orbit(venus_distance, venus_eccentricity, (3.4/180)*Math.PI, (76.6/180)*Math.PI, 0xffa500, 1000).draw();
scene.add(venus_line);

// Earth's Orbit
earth_line = new Orbit(earth_distance, earth_eccentricity, 0, (175/180)*Math.PI, 0x00bfff, 1000).draw();
scene.add(earth_line);

// Moon's Orbit
moon_line = new Orbit(moon_distance, moon_eccentricity, 0, 0, 0x555555, 1000).draw();
orbit_moon.add(moon_line);;

// Mars's Orbit
mars_line = new Orbit(mars_distance, mars_eccentricity, (1.85/180)*Math.PI, (49.7/180)*Math.PI, 0xff0000, 1000).draw();
scene.add(mars_line);

// Ceres's Orbit
ceres_line = new Orbit(ceres_distance, ceres_eccentricity, (10.593/180)*Math.PI, (80.3/180)*Math.PI, 0x555555, 1000).draw();
scene.add(ceres_line);

// Jupiter's Orbit
jupiter_line = new Orbit(jupiter_distance, jupiter_eccentricity, (1.3/180)*Math.PI, (100/180)*Math.PI, 0xffb6c1, 1000).draw();
scene.add(jupiter_line);

// Io's Orbit
io_line = new Orbit(io_distance, io_eccentricity, 0, 0, 0x756f32, 1000).draw();
orbit_io.add(io_line);

// Europa's Orbit
europa_line = new Orbit(europa_distance, europa_eccentricity, 0, 0, 0x9c769e, 1000).draw();
orbit_europa.add(europa_line);

// Ganymede's Orbit
ganymede_line = new Orbit(ganymede_distance, ganymede_eccentricity, 0, 0, 0x63709b, 1000).draw();
orbit_ganymede.add(ganymede_line);

// Callisto's Orbit
callisto_line = new Orbit(callisto_distance, callisto_eccentricity, 0, 0, 0x6d3a3a, 1000).draw();
orbit_callisto.add(callisto_line);

// Saturn's Orbit
saturn_line = new Orbit(saturn_distance, saturn_eccentricity, (2.5/180)*Math.PI, (114/180)*Math.PI, 0xdaa520, 1000).draw();
scene.add(saturn_line);

// Mimas's Orbit
mimas_line = new Orbit(mimas_distance, mimas_eccentricity, 0, 0, 0x708396, 1000).draw();
orbit_mimas.add(mimas_line);

// Enceladus's Orbit
enceladus_line = new Orbit(enceladus_distance, enceladus_eccentricity, 0, 0, 0xa8d3ff, 1000).draw();
orbit_enceladus.add(enceladus_line);

// Tethys's Orbit
tethys_line = new Orbit(tethys_distance, tethys_eccentricity, 0, 0, 0x8cad9f, 1000).draw();
orbit_tethys.add(tethys_line);

// Dione's Orbit
dione_line = new Orbit(dione_distance, dione_eccentricity, 0, 0, 0x5f7f64, 1000).draw();
orbit_dione.add(dione_line);

// Rhea's Orbit
rhea_line = new Orbit(rhea_distance, rhea_eccentricity, 0, 0, 0x586696, 1000).draw();
orbit_rhea.add(rhea_line);

// Titan's Orbit
titan_line = new Orbit(titan_distance, titan_eccentricity, 0, 0, 0xbf3900, 1000).draw();
orbit_titan.add(titan_line);

// Iapetus's Orbit
iapetus_line = new Orbit(iapetus_distance, iapetus_eccentricity, 0, 0, 0x51487c, 1000).draw();
orbit_iapetus.add(iapetus_line);

// Uranus's Orbit
uranus_line = new Orbit(uranus_distance, uranus_eccentricity, (0.772/180)*Math.PI, (74/180)*Math.PI, 0x00ffff, 1000).draw();
scene.add(uranus_line);

// Miranda's Orbit
miranda_line = new Orbit(miranda_distance, miranda_eccentricity, 0, 0, 0x597253, 1000).draw();
orbit_miranda.add(miranda_line);

// Ariel's Orbit
ariel_line = new Orbit(ariel_distance, ariel_eccentricity, 0, 0, 0x535b72, 1000).draw();
orbit_ariel.add(ariel_line);

// Umbriel's Orbit
umbriel_line = new Orbit(umbriel_distance, umbriel_eccentricity, 0, 0, 0x5d8280, 1000).draw();
orbit_umbriel.add(umbriel_line);

// Titania's Orbit
titania_line = new Orbit(titania_distance, titania_eccentricity, 0, 0, 0x2f8e8a, 1000).draw();
orbit_titania.add(titania_line);

// Oberon's Orbit
oberon_line = new Orbit(oberon_distance, oberon_eccentricity, 0, 0, 0x2c8c44, 1000).draw();
orbit_oberon.add(oberon_line);

// Neptune's Orbit
neptune_line = new Orbit(neptune_distance, neptune_eccentricity, (1.77/180)*Math.PI, (132/180)*Math.PI, 0x0000ff, 1000).draw();
scene.add(neptune_line);

// Triton's Orbit
triton_line = new Orbit(triton_distance, triton_eccentricity, 0, 0, 0x4a2982, 1000).draw();
orbit_triton.add(triton_line);

// Pluto's Orbit
pluto_line = new Orbit(pluto_distance, pluto_eccentricity, (17/180)*Math.PI, (110/180)*Math.PI, 0xbc8f8f, 1000).draw();
scene.add(pluto_line);

// Eris's Orbit
eris_line = new Orbit(eris_distance, eris_eccentricity, (44.0445/180)*Math.PI, (36.1/180)*Math.PI, 0x3b5277, 1000).draw();
scene.add(eris_line);

// Sedna's Orbit
sedna_line = new Orbit(sedna_distance, sedna_eccentricity, (11.92872/180)*Math.PI, (144/180)*Math.PI, 0x911f4b, 1000).draw();
scene.add(sedna_line);

//Egg's Orbit
egg_line = new Orbit(egg_distance, egg_eccentricity, 0, (175/180)*Math.PI, 0x00bf9f, 1000).draw();
scene.add(egg_line);

//**************************************************

// Set a toggle for the camera
// By default, the camera is pointed at the Sun

sun_camera = new THREE.Object3D(); sun.add(sun_camera);
mercury_camera = new THREE.Object3D(); mercury.add(mercury_camera);
venus_camera = new THREE.Object3D(); venus.add(venus_camera);
earth_camera = new THREE.Object3D(); earth.add(earth_camera);
moon_camera = new THREE.Object3D(); moon.add(moon_camera);
mars_camera = new THREE.Object3D(); mars.add(mars_camera);
ceres_camera = new THREE.Object3D(); ceres.add(ceres_camera);
jupiter_camera = new THREE.Object3D(); jupiter.add(jupiter_camera);
io_camera = new THREE.Object3D(); io.add(io_camera);
europa_camera = new THREE.Object3D(); europa.add(europa_camera);
ganymede_camera = new THREE.Object3D(); ganymede.add(ganymede_camera);
callisto_camera = new THREE.Object3D(); callisto.add(callisto_camera);
saturn_camera = new THREE.Object3D(); saturn.add(saturn_camera);
mimas_camera = new THREE.Object3D(); mimas.add(mimas_camera);
enceladus_camera = new THREE.Object3D(); enceladus.add(enceladus_camera);
tethys_camera = new THREE.Object3D(); tethys.add(tethys_camera);
dione_camera = new THREE.Object3D(); dione.add(dione_camera);
rhea_camera = new THREE.Object3D(); rhea.add(rhea_camera);
titan_camera = new THREE.Object3D(); titan.add(titan_camera);
iapetus_camera = new THREE.Object3D(); iapetus.add(iapetus_camera);
uranus_camera = new THREE.Object3D(); uranus.add(uranus_camera);
miranda_camera = new THREE.Object3D(); miranda.add(miranda_camera);
ariel_camera = new THREE.Object3D(); ariel.add(ariel_camera);
umbriel_camera = new THREE.Object3D(); umbriel.add(umbriel_camera);
titania_camera = new THREE.Object3D(); titania.add(titania_camera);
oberon_camera = new THREE.Object3D(); oberon.add(oberon_camera);
neptune_camera = new THREE.Object3D(); neptune.add(neptune_camera);
triton_camera = new THREE.Object3D(); triton.add(triton_camera);
pluto_camera = new THREE.Object3D(); pluto_charon.add(pluto_camera);
eris_camera = new THREE.Object3D(); eris.add(eris_camera);
sedna_camera = new THREE.Object3D(); sedna.add(sedna_camera);
egg_camera = new THREE.Object3D(); egg.add(egg_camera);

view_gui = new dat.GUI();
look_At_Moon = {Moon: function() {moon_camera.add(camera); camera.position.z = earth_distance/17000.0; camera.lookAt(moon.position);}}
look_At_Io = {Io: function() {io_camera.add(camera); camera.position.z = earth_distance/17000.0; camera.lookAt(io.position);}}
look_At_Europa = {Europa: function() {europa_camera.add(camera); camera.position.z = earth_distance/17000.0; camera.lookAt(europa.position);}}
look_At_Ganymede = {Ganymede: function() {ganymede_camera.add(camera); camera.position.z = earth_distance/17000.0; camera.lookAt(ganymede.position);}}
look_At_Callisto = {Callisto: function() {callisto_camera.add(camera); camera.position.z = earth_distance/17000.0; camera.lookAt(callisto.position);}}
look_At_Mimas = {Mimas: function() {mimas_camera.add(camera); camera.position.z = earth_distance/35000.0; camera.lookAt(mimas.position);}}
look_At_Enceladus = {Enceladus: function() {enceladus_camera.add(camera); camera.position.z = earth_distance/27000.0; camera.lookAt(enceladus.position);}}
look_At_Tethys = {Tethys: function() {tethys_camera.add(camera); camera.position.z = earth_distance/17000.0; camera.lookAt(tethys.position);}}
look_At_Dione = {Dione: function() {dione_camera.add(camera); camera.position.z = earth_distance/17000.0; camera.lookAt(dione.position);}}
look_At_Rhea = {Rhea: function() {rhea_camera.add(camera); camera.position.z = earth_distance/17000.0;camera.lookAt(rhea.position);}}
look_At_Titan = {Titan: function() {titan_camera.add(camera);  camera.position.z = earth_distance/17000.0; camera.lookAt(titan.position);}}
look_At_Iapetus = {Iapetus: function() {iapetus_camera.add(camera); camera.position.z = earth_distance/20000.0; camera.lookAt(iapetus.position);}}
look_At_Miranda = {Miranda: function() {miranda_camera.add(camera); camera.position.z = earth_distance/32000.0; camera.lookAt(miranda.position);}}
look_At_Ariel = {Ariel: function() {ariel_camera.add(camera); camera.position.z = earth_distance/17000.0; camera.lookAt(ariel.position);}}
look_At_Umbriel = {Umbriel: function() {umbriel_camera.add(camera); camera.position.z = earth_distance/17000.0; camera.lookAt(umbriel.position);}}
look_At_Titania = {Titania: function() {titania_camera.add(camera); camera.position.z = earth_distance/17000.0; camera.lookAt(titania.position);}}
look_At_Oberon = {Oberon: function() {oberon_camera.add(camera); camera.position.z = earth_distance/20000.0; camera.lookAt(oberon.position);}}
look_At_Triton = {Triton: function() {triton_camera.add(camera); camera.position.z = earth_distance/17000.0; camera.lookAt(triton.position);}}

look_At_Sun = {Sun: function() {sun_camera.add(camera); camera.position.z = earth_distance/5.0; camera.lookAt(sun.position);}}
look_At_Mercury = {Mercury: function() {mercury_camera.add(camera); camera.position.z = earth_distance/17000.0; camera.lookAt(mercury.position);}}
look_At_Venus = {Venus: function() {venus_camera.add(camera); camera.position.z = earth_distance/7000.0; camera.lookAt(venus.position);}}
look_At_Earth = {Earth: function() {earth_camera.add(camera); camera.position.z = earth_distance/6500.0; camera.lookAt(earth.position);}}
look_At_Mars = {Mars: function() {mars_camera.add(camera); camera.position.z = earth_distance/12000.0; camera.lookAt(mars.position);}}
look_At_Ceres = {Ceres: function() {ceres_camera.add(camera); camera.position.z = earth_distance/27000.0; camera.lookAt(ceres.position);}}
look_At_Jupiter = {Jupiter: function() {jupiter_camera.add(camera); camera.position.z = earth_distance/500.0; camera.lookAt(jupiter.position);}}
look_At_Saturn = {Saturn: function() {saturn_camera.add(camera); camera.position.z = earth_distance/500.0; camera.lookAt(saturn.position);}}
look_At_Uranus = {Uranus: function() {uranus_camera.add(camera); camera.position.z = earth_distance/17000.0; camera.lookAt(uranus.position);}}
look_At_Neptune = {Neptune: function() {neptune_camera.add(camera); camera.position.z = earth_distance/17000.0; camera.lookAt(neptune.position);}}
look_At_Pluto = {Pluto: function() {pluto_camera.add(camera); camera.position.z = earth_distance/11000.0; camera.lookAt(pluto_charon.position);}}
look_At_Eris = {Eris: function() {eris_camera.add(camera); camera.position.z = earth_distance/11000.0; camera.lookAt(eris.position);}}
look_At_Sedna = {Sedna: function() {sedna_camera.add(camera); camera.position.z = earth_distance/11000.0; camera.lookAt(sedna.position);}}
look_At_Egg = {Egg: function() {egg_camera.add(camera); camera.position.z = earth_distance/6500.0; camera.lookAt(egg.position);}}

var planets = view_gui.addFolder('Sun and Planets');
planets.add(look_At_Sun, 'Sun');
planets.add(look_At_Mercury, 'Mercury');
planets.add(look_At_Venus, 'Venus');
planets.add(look_At_Earth, 'Earth');
planets.add(look_At_Mars, 'Mars');
planets.add(look_At_Jupiter, 'Jupiter');
planets.add(look_At_Saturn, 'Saturn');
planets.add(look_At_Uranus, 'Uranus');
planets.add(look_At_Neptune, 'Neptune');

var dwarf_planets = view_gui.addFolder('Dwarf Planets');
dwarf_planets.add(look_At_Ceres, 'Ceres');
dwarf_planets.add(look_At_Pluto, 'Pluto');
dwarf_planets.add(look_At_Eris, 'Eris');
dwarf_planets.add(look_At_Sedna, 'Sedna');

var moons = view_gui.addFolder('Moons');
moons.add(look_At_Moon, 'Moon');
moons.add(look_At_Io, 'Io');
moons.add(look_At_Europa, 'Europa');
moons.add(look_At_Ganymede, 'Ganymede');
moons.add(look_At_Callisto, 'Callisto');
moons.add(look_At_Mimas, 'Mimas');
moons.add(look_At_Enceladus, 'Enceladus');
moons.add(look_At_Tethys, 'Tethys');
moons.add(look_At_Dione, 'Dione');
moons.add(look_At_Rhea, 'Rhea');
moons.add(look_At_Titan, 'Titan');
moons.add(look_At_Iapetus, 'Iapetus');
moons.add(look_At_Miranda, 'Miranda');
moons.add(look_At_Ariel, 'Ariel');
moons.add(look_At_Umbriel, 'Umbriel');
moons.add(look_At_Titania, 'Titania');
moons.add(look_At_Oberon, 'Oberon');
moons.add(look_At_Triton, 'Triton');

view_gui.add(look_At_Egg, 'Egg');

// Set a toggle switch for the orbits
// By default, the orbits of the planets are not visible.

mercury_line.visible = false;
venus_line.visible = false;
earth_line.visible = false;
moon_line.visible = false;
mars_line.visible = false;
ceres_line.visible = false;
jupiter_line.visible = false;
io_line.visible = false;
europa_line.visible = false;
ganymede_line.visible = false;
callisto_line.visible = false;
saturn_line.visible = false;
mimas_line.visible = false;
enceladus_line.visible = false;
tethys_line.visible = false;
dione_line.visible = false;
rhea_line.visible = false;
titan_line.visible = false;
iapetus_line.visible = false;
uranus_line.visible = false;
miranda_line.visible = false;
ariel_line.visible = false;
umbriel_line.visible = false;
titania_line.visible = false;
oberon_line.visible = false;
neptune_line.visible = false;
triton_line.visible = false;
pluto_line.visible = false;
eris_line.visible = false;
sedna_line.visible = false;
egg_line.visible = false;

control_gui = new dat.GUI();
orbits_off = {
	OFF: function() {
		mercury_line.traverse(function() {mercury_line.visible = false;});
		venus_line.traverse(function() {venus_line.visible = false;});
		earth_line.traverse(function() {earth_line.visible = false;});
		mars_line.traverse(function() {mars_line.visible = false;});
		jupiter_line.traverse(function() {jupiter_line.visible = false;});
		saturn_line.traverse(function() {saturn_line.visible = false;});
		uranus_line.traverse(function() {uranus_line.visible = false;});
		neptune_line.traverse(function() {neptune_line.visible = false;});
	}
}
orbits_on = {
	ON: function() {
		mercury_line.traverse(function() {mercury_line.visible = true;});
                venus_line.traverse(function() {venus_line.visible = true;});
                earth_line.traverse(function() {earth_line.visible = true;});
                mars_line.traverse(function() {mars_line.visible = true;});
                jupiter_line.traverse(function() {jupiter_line.visible = true;});
                saturn_line.traverse(function() {saturn_line.visible = true;});
                uranus_line.traverse(function() {uranus_line.visible = true;});
                neptune_line.traverse(function() {neptune_line.visible = true;});
	}
}

dwarf_orbits_off = {
	OFF: function() {
		ceres_line.traverse(function() {ceres_line.visible = false;});
		pluto_line.traverse(function() {pluto_line.visible = false;});
		eris_line.traverse(function() {eris_line.visible = false;});
		sedna_line.traverse(function() {sedna_line.visible = false;});
	}
}

dwarf_orbits_on = {
	ON: function() {
		ceres_line.traverse(function() {ceres_line.visible = true;});
                pluto_line.traverse(function() {pluto_line.visible = true;});
                eris_line.traverse(function() {eris_line.visible = true;});
                sedna_line.traverse(function() {sedna_line.visible = true;});
	}
}

moon_orbits_off = {
	OFF: function() {
		moon_line.traverse(function() {moon_line.visible = false;});
		io_line.traverse(function() {io_line.visible = false;});
                europa_line.traverse(function() {europa_line.visible = false;});
                ganymede_line.traverse(function() {ganymede_line.visible = false;});
                callisto_line.traverse(function() {callisto_line.visible = false;});
		mimas_line.traverse(function() {mimas_line.visible = false;});
                enceladus_line.traverse(function() {enceladus_line.visible = false;});
                tethys_line.traverse(function() {tethys_line.visible = false;});
                dione_line.traverse(function() {dione_line.visible = false;});
                rhea_line.traverse(function() {rhea_line.visible = false;});
                titan_line.traverse(function() {titan_line.visible = false;});
                iapetus_line.traverse(function() {iapetus_line.visible = false;});
		miranda_line.traverse(function() {miranda_line.visible = false;});
                ariel_line.traverse(function() {ariel_line.visible = false;});
                umbriel_line.traverse(function() {umbriel_line.visible = false;});
                titania_line.traverse(function() {titania_line.visible = false;});
                oberon_line.traverse(function() {oberon_line.visible = false;});
		triton_line.traverse(function() {triton_line.visible = false;});
	}
}

moon_orbits_on = {
        ON: function() {
                moon_line.traverse(function() {moon_line.visible = true;});
                io_line.traverse(function() {io_line.visible = true;});
                europa_line.traverse(function() {europa_line.visible = true;});
                ganymede_line.traverse(function() {ganymede_line.visible = true;});
                callisto_line.traverse(function() {callisto_line.visible = true;});
                mimas_line.traverse(function() {mimas_line.visible = true;});
                enceladus_line.traverse(function() {enceladus_line.visible = true;});
                tethys_line.traverse(function() {tethys_line.visible = true;});
                dione_line.traverse(function() {dione_line.visible = true;});
                rhea_line.traverse(function() {rhea_line.visible = true;});
                titan_line.traverse(function() {titan_line.visible = true;});
                iapetus_line.traverse(function() {iapetus_line.visible = true;});
                miranda_line.traverse(function() {miranda_line.visible = true;});
                ariel_line.traverse(function() {ariel_line.visible = true;});
                umbriel_line.traverse(function() {umbriel_line.visible = true;});
                titania_line.traverse(function() {titania_line.visible = true;});
                oberon_line.traverse(function() {oberon_line.visible = true;});
                triton_line.traverse(function() {triton_line.visible = true;});
        }
}

var orbits = control_gui.addFolder('Planet Orbits');
orbits.add(orbits_on, 'ON');
orbits.add(orbits_off, 'OFF');

var dwarf_orbits = control_gui.addFolder('Dwarf Planet Orbits');
dwarf_orbits.add(dwarf_orbits_on, 'ON');
dwarf_orbits.add(dwarf_orbits_off, 'OFF');

var moon_orbits = control_gui.addFolder('Moon Orbits');
moon_orbits.add(moon_orbits_on, 'ON');
moon_orbits.add(moon_orbits_off, 'OFF');

// Set a toggle for clouds and atmospheres
// By default, the clouds and atmospheres of the planets are visible.

venus_clouds.visible = true;
earth_clouds.visible = true;
mars_clouds.visible = true;
titan_clouds.visible = true;

//cloud_gui = new dat.GUI();
atmospheres_off = {
	OFF: function() {
		venus_clouds.traverse(function() {venus_clouds.visible = false;});
		earth_clouds.traverse(function() {earth_clouds.visible = false;});
		mars_clouds.traverse(function() {mars_clouds.visible = false;});
		titan_clouds.traverse(function() {titan_clouds.visible = false;});
	}
}
atmospheres_on = {
	ON: function() {
		venus_clouds.traverse(function() {venus_clouds.visible = true;});
                earth_clouds.traverse(function() {earth_clouds.visible = true;});
                mars_clouds.traverse(function() {mars_clouds.visible = true;});
		titan_clouds.traverse(function() {titan_clouds.visible = true;});
	}
}
var atmospheres = control_gui.addFolder('Atmospheres');
atmospheres.add(atmospheres_on, 'ON');
atmospheres.add(atmospheres_off, 'OFF');

//*******************************************************************

function rotatePlanets() {
	
	// Set rotation obliquities(tilts) for the Sun and Planets.
	sun.rotation.x = (7.25/180)*Math.PI;
	mercury.rotation.x = (0.03/180)*Math.PI;
	venus.rotation.x = (2.64/180)*Math.PI;
	earth.rotation.x = (23.45/180)*Math.PI;
	mars.rotation.x = (25.19/180)*Math.PI;
	ceres.rotation.x = (4.00/180)*Math.PI;
	jupiter.rotation.x = (3.13/180)*Math.PI;
	saturn.rotation.x = (26.73/180)*Math.PI;
	uranus.rotation.x = (97.77/180)*Math.PI;
	neptune.rotation.x = (28.32/180)*Math.PI;
	pluto_charon.rotation.x = (122.53/180)*Math.PI;
	eris.rotation.x = (43.9/180)*Math.PI;
	sedna.rotation.x = (0/180)*Math.PI; //unknown

	// Adjust ring orientations to line up w/ planets' equators
	jupiter_rings.rotation.x = (90/180)*Math.PI;
	saturn_rings.rotation.x = (90/180)*Math.PI;
	uranus_rings.rotation.x = (90/180)*Math.PI;
	neptune_rings.rotation.x = (90/180)*Math.PI;

	// Adjust cloud rotation(s)
	venus_clouds.rotation.y = Date.now() * (-0.25*earth_rotation);
	earth_clouds.rotation.y = Date.now() * (1.5*earth_rotation);
	mars_clouds.rotation.y = Date.now() * (1.3*earth_rotation);

	// Rotation rates of the Sun and Planets
	sun.rotation.y = Date.now() * sun_rotation;
	mercury.rotation.y = Date.now() * mercury_rotation;
	venus.rotation.y = Date.now() * venus_rotation;
	earth.rotation.y = Date.now() * earth_rotation;
	mars.rotation.y = Date.now() * mars_rotation;
	ceres.rotation.y = Date.now() * ceres_rotation;
	jupiter.rotation.y = Date.now() * jupiter_rotation;
	saturn.rotation.y = Date.now() * saturn_rotation;
	uranus.rotation.y = Date.now() * uranus_rotation;
	neptune.rotation.y = Date.now() * neptune_rotation;
	pluto_charon.rotation.y = Date.now() * pluto_rotation;
	eris.rotation.y = Date.now() * eris_rotation;
	sedna.rotation.y = Date.now() * sedna_rotation;
}

function revolvePlanets() {
        
	// This block determines the positions of the planets on their elliptical (rather than circular) paths.
	mercury.position.x = Math.sin(Date.now() * mercury_year) * mercury_distance + mercury_eccentricity;
        mercury.position.z = Math.cos(Date.now() * mercury_year) * (mercury_distance - 0.5 * mercury_eccentricity);
 
	venus.position.x = Math.sin(Date.now() * venus_year) * venus_distance + venus_eccentricity;
	venus.position.z = Math.cos(Date.now() * venus_year) * (venus_distance - 0.5 * venus_eccentricity);
 
	earth.position.x = Math.sin(Date.now() * earth_year) * earth_distance + earth_eccentricity;
	earth.position.z = Math.cos(Date.now() * earth_year) * (earth_distance - 0.5 * earth_eccentricity);

	mars.position.x = Math.sin(Date.now() * mars_year) * mars_distance + mars_eccentricity;
	mars.position.z = Math.cos(Date.now() * mars_year) * (mars_distance - 0.5 * mars_eccentricity);

	ceres.position.x = Math.sin(Date.now() * ceres_year) * ceres_distance + ceres_eccentricity;
	ceres.position.z = Math.cos(Date.now() * ceres_year) * (ceres_distance - 0.5 * ceres_eccentricity);

	jupiter.position.x = Math.sin(Date.now() * jupiter_year) * jupiter_distance + jupiter_eccentricity;
	jupiter.position.z = Math.cos(Date.now() * jupiter_year) * (jupiter_distance - 0.5 * jupiter_eccentricity);

	saturn.position.x = Math.sin(Date.now() * saturn_year) * saturn_distance + saturn_eccentricity;
	saturn.position.z = Math.cos(Date.now() * saturn_year) * (saturn_distance - 0.5 * saturn_eccentricity);

	uranus.position.x = Math.sin(Date.now() * uranus_year) * uranus_distance + uranus_eccentricity;
	uranus.position.z = Math.cos(Date.now() * uranus_year) * (uranus_distance - 0.5 * uranus_eccentricity);
 
	neptune.position.x = Math.sin(Date.now() * neptune_year) * neptune_distance + neptune_eccentricity;
	neptune.position.z = Math.cos(Date.now() * neptune_year) * (neptune_distance - 0.5 * neptune_eccentricity);
 
	pluto_charon.position.x = Math.sin(Date.now() * pluto_year) * pluto_distance + pluto_eccentricity;
	pluto_charon.position.z = Math.cos(Date.now() * pluto_year) * (pluto_distance - 0.5 * pluto_eccentricity);

	eris.position.x = Math.sin(Date.now() * eris_year) * eris_distance + eris_eccentricity;
        eris.position.z = Math.cos(Date.now() * eris_year) * (eris_distance - 0.5 * eris_eccentricity);

	sedna.position.x = Math.sin(Date.now() * sedna_year) * sedna_distance + sedna_eccentricity;
        sedna.position.z = Math.cos(Date.now() * sedna_year) * (sedna_distance - 0.5 * sedna_eccentricity);

	egg.position.x = Math.sin(Date.now() * egg_year) * egg_distance + egg_eccentricity;
	egg.position.z = Math.cos(Date.now() * egg_year) * (egg_distance - 0.5 * egg_eccentricity);
}

function rotateMoons() {
	// The orbital rates are now accurate. And, orbital parameters have also been included!

	// Cameras
	sun_camera.rotation.y = Date.now() * -sun_rotation;
	mercury_camera.rotation.y = Date.now() * -mercury_rotation;
	venus_camera.rotation.y = Date.now() * -venus_rotation;
	earth_camera.rotation.y = Date.now() * -earth_rotation;
	moon_camera.rotation.y = Date.now() * -moon_rotation;
	mars_camera.rotation.y = Date.now() * -mars_rotation;
	ceres_camera.rotation.y = Date.now() * -ceres_rotation;
	jupiter_camera.rotation.y = Date.now() * -jupiter_rotation;
	io_camera.rotation.y = Date.now() * -io_rotation;
	europa_camera.rotation.y = Date.now() * -europa_rotation;
	ganymede_camera.rotation.y = Date.now() * -ganymede_rotation;
	callisto_camera.rotation.y = Date.now() * -callisto_rotation;
	saturn_camera.rotation.y = Date.now() * -saturn_rotation;
	mimas_camera.rotation.y = Date.now() * -mimas_rotation;
	enceladus_camera.rotation.y = Date.now() * -enceladus_rotation;
	tethys_camera.rotation.y = Date.now() * -tethys_rotation;
	dione_camera.rotation.y = Date.now() * -dione_rotation;
	rhea_camera.rotation.y = Date.now() * -rhea_rotation;
	titan_camera.rotation.y = Date.now() * -titan_rotation;
	iapetus_camera.rotation.y = Date.now() * -iapetus_rotation;
	uranus_camera.rotation.y = Date.now() * -uranus_rotation;
	miranda_camera.rotation.y = Date.now() * -miranda_rotation;
	ariel_camera.rotation.y = Date.now() * -ariel_rotation;
	umbriel_camera.rotation.y = Date.now() * -umbriel_rotation;
	titania_camera.rotation.y = Date.now() * -titania_rotation;
	oberon_camera.rotation.y = Date.now() * -oberon_rotation;	
	neptune_camera.rotation.y = Date.now() * -neptune_rotation;
	triton_camera.rotation.y = Date.now() * -triton_rotation;
	pluto_camera.rotation.y = Date.now() * -pluto_rotation;
	eris_camera.rotation.y = Date.now() * -eris_rotation;
	sedna_camera.rotation.y = Date.now() * -sedna_rotation;
	egg_camera.rotation.y = Date.now() * -egg_rotation;

	// Rings
	jupiter_rings.rotation.z = Date.now() * jupiter_rotation;
	saturn_rings.rotation.z = Date.now() * saturn_rotation;
	uranus_rings.rotation.z = Date.now() * uranus_rotation;
	neptune_rings.rotation.z = Date.now() * neptune_rotation;
	
	// Earth's Moon
	moon.position.x = Math.sin(Date.now() * moon_rotation) * moon_distance + moon_eccentricity;
	moon.position.z = Math.cos(Date.now() * moon_rotation) * (moon_distance - 0.5 * moon_eccentricity);
	moon.rotation.y = (90/180)*Math.PI + Date.now() * moon_rotation; // Orients the Moon so that the near side is facing Earth.
	moons_orbit.rotation.y = Date.now() * (-earth_rotation);

	// Jupiter's four Galilean Moons
	// Was able to achieve the 4:2:1 orbital resonance of Io, Europa, and Ganymede
	io.position.x = Math.sin(Date.now() * io_rotation) * io_distance + io_eccentricity;;
	io.position.z = Math.cos(Date.now() * io_rotation) * (io_distance - 0.5 * io_eccentricity);
	io.rotation.y = Date.now() * io_rotation;
        ios_orbit.rotation.y = Date.now() * (-jupiter_rotation);
        
	europa.position.x = Math.sin(Date.now() * europa_rotation) * europa_distance + europa_eccentricity;
	europa.position.z = Math.cos(Date.now() * europa_rotation) * (europa_distance - 0.5 * europa_eccentricity);
        europa.rotation.y = Date.now() * europa_rotation;
	europas_orbit.rotation.y = Date.now() * (-jupiter_rotation);
	
	ganymede.position.x = Math.sin(Date.now() * ganymede_rotation) * ganymede_distance + ganymede_eccentricity;
	ganymede.position.z = Math.cos(Date.now() * ganymede_rotation) * (ganymede_distance - 0.5 * ganymede_eccentricity);
	ganymede.rotation.y = Date.now() * ganymede_rotation;
	ganymedes_orbit.rotation.y = Date.now() * (-jupiter_rotation);
	
	callisto.position.x = Math.sin(Date.now() * callisto_rotation) * callisto_distance + callisto_eccentricity;
	callisto.position.z = Math.cos(Date.now() * callisto_rotation) * (callisto_distance - 0.5 * callisto_eccentricity);
	callisto.rotation.y = Date.now() * callisto_rotation;
	callistos_orbit.rotation.y = Date.now() * (-jupiter_rotation);

	// Saturn's Moons
	mimas.position.x = Math.sin(Date.now() * mimas_rotation) * mimas_distance + mimas_eccentricity;
	mimas.position.z = Math.cos(Date.now() * mimas_rotation) * (mimas_distance - 0.5 * mimas_eccentricity);
	mimas.rotation.y = (-50/180)*Math.PI + Date.now() * mimas_rotation;
	mimass_orbit.rotation.y = Date.now() * (-saturn_rotation);

	enceladus.position.x = Math.sin(Date.now() * enceladus_rotation) * enceladus_distance + enceladus_eccentricity;
	enceladus.position.z = Math.cos(Date.now() * enceladus_rotation) * (enceladus_distance  - 0.5 * enceladus_eccentricity);
	enceladus.rotation.y = Date.now() * enceladus_rotation;
	enceladuss_orbit.rotation.y = Date.now() * (-saturn_rotation);

	tethys.position.x = Math.sin(Date.now() * tethys_rotation) * tethys_distance + tethys_eccentricity;
	tethys.position.z = Math.cos(Date.now() * tethys_rotation) * (tethys_distance - 0.5 * tethys_eccentricity);
	tethys.rotation.y = Date.now() * tethys_rotation;
	tethyss_orbit.rotation.y = Date.now() * (-saturn_rotation);

	dione.position.x = Math.sin(Date.now() * dione_rotation) * dione_distance + dione_eccentricity;
	dione.position.z = Math.cos(Date.now() * dione_rotation) * (dione_distance - 0.5 * dione_eccentricity);
	dione.rotation.y = Date.now() * dione_rotation;
	diones_orbit.rotation.y = Date.now() * (-saturn_rotation);

	rhea.position.x = Math.sin(Date.now() * rhea_rotation) * rhea_distance + rhea_eccentricity;
	rhea.position.z = Math.cos(Date.now() * rhea_rotation) * (rhea_distance - 0.5 * rhea_eccentricity);
	rhea.rotation.y = Date.now() * rhea_rotation;
	rheas_orbit.rotation.y = Date.now() * (-saturn_rotation);

	titan.position.x = Math.sin(Date.now() * titan_rotation) * titan_distance + titan_eccentricity;
	titan.position.z = Math.cos(Date.now() * titan_rotation) * (titan_distance - 0.5 * titan_eccentricity);
	titan.rotation.y = Date.now() * titan_rotation;
	titan_clouds.rotation.y = Date.now() * (0.1 * earth_rotation);
	titans_orbit.rotation.y = Date.now() * (-saturn_rotation);

	iapetus.position.x = Math.sin(Date.now() * iapetus_rotation) * iapetus_distance + iapetus_eccentricity;
	iapetus.position.z = Math.cos(Date.now() * iapetus_rotation) * (iapetus_distance - 0.5 * iapetus_eccentricity);
	iapetus.rotation.y = Date.now() * iapetus_rotation;
	iapetuss_orbit.rotation.y = Date.now() * (-saturn_rotation); 

	// Uranus's Moons
	miranda.position.x = Math.sin(Date.now() * miranda_rotation) * miranda_distance + miranda_eccentricity;
	miranda.position.z = Math.cos(Date.now() * miranda_rotation) * (miranda_distance - 0.5 * miranda_eccentricity);
	miranda.rotation.y = Date.now() * miranda_rotation;
	mirandas_orbit.rotation.y = Date.now() * (-uranus_rotation);

	ariel.position.x = Math.sin(Date.now() * ariel_rotation) * ariel_distance + ariel_eccentricity;
	ariel.position.z = Math.cos(Date.now() * ariel_rotation) * (ariel_distance - 0.5 * ariel_eccentricity);
	ariel.rotation.y = Date.now() * ariel_rotation;
	ariels_orbit.rotation.y = Date.now() * (-uranus_rotation);

	umbriel.position.x = Math.sin(Date.now() * umbriel_rotation) * umbriel_distance + umbriel_eccentricity;
	umbriel.position.z = Math.cos(Date.now() * umbriel_rotation) * (umbriel_distance - 0.5 * umbriel_eccentricity);
	umbriel.rotation.y = Date.now() * umbriel_rotation;
	umbriels_orbit.rotation.y = Date.now() * (-uranus_rotation);

	titania.position.x = Math.sin(Date.now() * titania_rotation) * titania_distance + titania_eccentricity;
	titania.position.z = Math.cos(Date.now() * titania_rotation) * (titania_distance - 0.5 * titania_eccentricity);
	titania.rotation.y = Date.now() * titania_rotation;
	titanias_orbit.rotation.y = Date.now() * (-uranus_rotation);

	oberon.position.x = Math.sin(Date.now() * oberon_rotation) * oberon_distance + oberon_eccentricity;
	oberon.position.z = Math.cos(Date.now() * oberon_rotation) * (oberon_distance - 0.5 * oberon_eccentricity);
	oberon.rotation.y = Date.now() * oberon_rotation;
	oberons_orbit.rotation.y = Date.now() * (-uranus_rotation);

	// Neptune's Moons
	triton.position.x = Math.sin(Date.now() * triton_rotation) * triton_distance + triton_eccentricity;
	triton.position.z = Math.cos(Date.now() * triton_rotation) * (triton_distance - 0.5 * triton_eccentricity);
	triton.rotation.y = Date.now() * triton_rotation;
	tritons_orbit.rotation.y = Date.now() * (-neptune_rotation);	// retrograde revolution

	// Since Pluto and Charon are tidally-locked to each other, they need not be included in this function.
}

draw();

function draw() {
	
	requestAnimationFrame(draw);
	
	rotatePlanets();
	revolvePlanets();
	rotateMoons();
	
	renderer.autoClear = false;
	renderer.sortObjects = false;
	renderer.clear();
	renderer.render(backgroundScene, backgroundCamera);
	renderer.render(scene, camera);
}
</script></body></html>
